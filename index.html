<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SkyTask Ultimate V6</title>
    
    <!-- SDKs: Telegram, Firebase, Animations, Icons, Alerts -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- MONETAG SDK (Zone 10544727) -->
    <script src='//libtl.com/sdk.js' data-zone='10544727' data-sdk='show_10544727'></script>

    <style>
        :root {
            --primary: #00f2ff; /* Neon Cyan */
            --secondary: #0078ff; /* Deep Blue */
            --danger: #ff0055; /* Hot Pink */
            --bg: #050b14;
            --card: rgba(16, 28, 45, 0.9);
            --border: 1px solid rgba(0, 242, 255, 0.2);
            --text: #ffffff;
            --mute: #8b9bb4;
        }

        body {
            background-color: var(--bg);
            background-image: 
                radial-gradient(circle at 20% 10%, rgba(0, 242, 255, 0.1), transparent 40%),
                radial-gradient(circle at 80% 90%, rgba(255, 0, 85, 0.1), transparent 40%);
            color: var(--text);
            font-family: 'Rajdhani', sans-serif;
            margin: 0; padding: 0; height: 100vh; overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- 1. HEADER & PROFILE --- */
        header {
            padding: 15px; background: rgba(5, 11, 20, 0.95);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: var(--border); z-index: 50;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        .profile-box { display: flex; align-items: center; gap: 12px; }
        .avatar-frame {
            width: 48px; height: 48px; padding: 2px;
            background: linear-gradient(45deg, var(--primary), var(--danger));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
        }
        .user-avatar {
            width: 100%; height: 100%; border-radius: 50%;
            object-fit: cover; border: 2px solid #000;
        }
        .lang-btn {
            background: rgba(255,255,255,0.05); border: var(--border);
            width: 40px; height: 40px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            color: var(--primary); cursor: pointer; transition: 0.3s;
        }

        /* --- 2. MAIN CONTENT --- */
        #app-content { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 110px; }

        .glass-card {
            background: var(--card); border: var(--border);
            border-radius: 16px; padding: 20px; margin-bottom: 15px;
            backdrop-filter: blur(10px); box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative; overflow: hidden;
        }
        
        /* Balance */
        .balance-title { font-size: 12px; color: var(--mute); letter-spacing: 2px; text-transform: uppercase; }
        .balance-num { font-family: 'Orbitron'; font-size: 36px; color: #fff; text-shadow: 0 0 15px var(--primary); margin: 5px 0; }
        .usd-tag { background: rgba(0, 242, 255, 0.1); padding: 5px 10px; border-radius: 20px; font-size: 12px; color: var(--primary); display: inline-block; }

        /* --- 3. ADS & BUTTONS --- */
        .ad-banner {
            width: 100%; height: 120px; border-radius: 15px;
            background: linear-gradient(45deg, #111, #222);
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 15px; cursor: pointer; border: 1px dashed var(--mute);
            position: relative; overflow: hidden;
        }
        .ad-banner img { width: 100%; height: 100%; object-fit: cover; opacity: 0.7; transition: 0.3s; }
        .ad-banner:hover img { opacity: 1; transform: scale(1.05); }
        .ad-badge { position: absolute; top: 10px; right: 10px; background: var(--danger); color: #fff; font-size: 10px; padding: 3px 8px; border-radius: 5px; }

        .hyper-btn {
            width: 100%; padding: 18px; border: none; border-radius: 15px;
            background: linear-gradient(90deg, var(--danger), #ff5e00, var(--danger));
            background-size: 200% auto; color: white;
            font-family: 'Orbitron'; font-size: 14px; letter-spacing: 1px;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            cursor: pointer; box-shadow: 0 0 20px rgba(255, 0, 85, 0.4);
            animation: fireFlow 2s infinite linear;
        }
        @keyframes fireFlow { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }

        /* --- 4. NAVIGATION --- */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(5, 11, 20, 0.98); border-top: var(--border);
            display: flex; justify-content: space-around; padding: 12px 0 25px 0;
            z-index: 100;
        }
        .nav-link {
            display: flex; flex-direction: column; align-items: center;
            color: var(--mute); font-size: 10px; cursor: pointer; transition: 0.3s;
            width: 33%; position: relative;
        }
        .nav-link i { font-size: 20px; margin-bottom: 6px; }
        .nav-link span { font-weight: 700; letter-spacing: 1px; }
        .nav-link.active { color: var(--primary); text-shadow: 0 0 10px var(--primary); }
        .nav-link.active i { transform: translateY(-3px); }

        /* --- 5. TUTORIAL & MODALS --- */
        .tutorial-mask {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 9000; display: none;
        }
        .tut-box {
            position: absolute; border: 2px solid var(--primary);
            box-shadow: 0 0 40px var(--primary); border-radius: 15px;
            transition: all 0.5s ease; pointer-events: none;
        }
        .tut-msg {
            position: absolute; background: #fff; color: #000;
            padding: 15px; border-radius: 10px; font-weight: bold; width: 220px;
            text-align: center; z-index: 9001;
        }

        .modal-wrap {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000; display: none;
            align-items: center; justify-content: center;
        }

        /* Inputs */
        .sky-input {
            width: 100%; padding: 15px; background: rgba(0,0,0,0.5);
            border: 1px solid #333; color: white; border-radius: 10px;
            margin-bottom: 10px; box-sizing: border-box; text-align: center;
            font-family: 'Rajdhani'; font-size: 16px;
        }
        .sky-input:focus { border-color: var(--primary); outline: none; }

        /* Helpers */
        .hidden { display: none !important; }
        .tab-section { display: none; animation: fadeIn 0.4s; }
        .tab-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <!-- LANGUAGE MODAL -->
    <div id="lang-modal" class="modal-wrap" style="display:flex;">
        <div class="glass-card" style="width: 80%; text-align: center;">
            <i class="fas fa-globe" style="font-size: 40px; color: var(--primary); margin-bottom: 20px;"></i>
            <h2 style="margin: 0 0 20px 0;">SELECT LANGUAGE</h2>
            <div onclick="setLang('en')" style="padding:15px; background:#111; margin-bottom:10px; border-radius:10px; border:1px solid #333; cursor:pointer;">ðŸ‡ºðŸ‡¸ English (Default)</div>
            <div onclick="setLang('hi')" style="padding:15px; background:#111; margin-bottom:10px; border-radius:10px; border:1px solid #333; cursor:pointer;">ðŸ‡®ðŸ‡³ Hindi</div>
            <div onclick="setLang('ar')" style="padding:15px; background:#111; margin-bottom:10px; border-radius:10px; border:1px solid #333; cursor:pointer;">ðŸ‡¸ðŸ‡¦ Arabic</div>
            <div onclick="setLang('fr')" style="padding:15px; background:#111; margin-bottom:10px; border-radius:10px; border:1px solid #333; cursor:pointer;">ðŸ‡«ðŸ‡· French</div>
        </div>
    </div>

    <!-- ADMIN MESSAGE (24H) -->
    <div id="admin-modal" class="modal-wrap">
        <div class="glass-card" style="width: 80%; text-align: center; border-color: var(--danger);">
            <i class="fas fa-bell" style="font-size: 40px; color: var(--danger); margin-bottom: 15px;"></i>
            <h3 style="font-family: 'Orbitron'; color: var(--danger);">IMPORTANT UPDATE</h3>
            <p style="color: #ccc; line-height: 1.5; font-size: 14px;">
                Welcome to SkyTask V6!<br>
                Daily Ad Limit: <b>20 Ads</b><br>
                Referral Reward: <b>$0.03</b> (After friend earns $0.50).
            </p>
            <button onclick="closeAdmin()" class="hyper-btn" style="padding: 10px; margin-top: 15px; background: #333; border: 1px solid #555;">CLOSE</button>
        </div>
    </div>

    <!-- TUTORIAL OVERLAY -->
    <div id="tutorial-overlay" class="tutorial-mask">
        <div id="tut-box" class="tut-box"></div>
        <div id="tut-text" class="tut-msg"></div>
    </div>

    <!-- HEADER -->
    <header>
        <div class="profile-box">
            <div class="avatar-frame">
                <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" id="user-pic" class="user-avatar" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3135/3135715.png'">
            </div>
            <div>
                <div style="font-size: 10px; color: var(--primary); letter-spacing: 1px;">OPERATOR</div>
                <div id="user-name" style="font-weight: 700;">GUEST</div>
            </div>
        </div>
        <div class="lang-btn" onclick="document.getElementById('lang-modal').style.display='flex'">
            <i class="fas fa-language" style="font-size: 20px;"></i>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div id="app-content">

        <!-- HOME TAB -->
        <div id="tab-home" class="tab-section active">
            <!-- Balance Card -->
            <div class="glass-card" id="tut-balance" style="text-align: center;">
                <div class="balance-title">CURRENT BALANCE</div>
                <div class="balance-num" id="bal-disp">0</div>
                <div class="usd-tag">â‰ˆ $<span id="usd-disp">0.0000</span></div>
            </div>

            <!-- Welcome Bonus (Auto Hide) -->
            <div id="bonus-card" class="glass-card" style="border-color: #00ff88;">
                <h3 style="margin: 0 0 15px 0; color: #00ff88; font-family: 'Orbitron';"><i class="fas fa-check-circle"></i> STARTUP TASKS</h3>
                <div onclick="doBonus('tg', this)" style="padding:12px; background:rgba(255,255,255,0.05); margin-bottom:5px; border-radius:8px; display:flex; justify-content:space-between; cursor:pointer;">
                    <span><i class="fab fa-telegram" style="color:#0088cc;"></i> Join Channel</span> <i class="fas fa-arrow-right"></i>
                </div>
                <div onclick="doBonus('yt', this)" style="padding:12px; background:rgba(255,255,255,0.05); margin-bottom:5px; border-radius:8px; display:flex; justify-content:space-between; cursor:pointer;">
                    <span><i class="fab fa-youtube" style="color:#ff0000;"></i> Subscribe</span> <i class="fas fa-arrow-right"></i>
                </div>
                <div onclick="doBonus('fb', this)" style="padding:12px; background:rgba(255,255,255,0.05); border-radius:8px; display:flex; justify-content:space-between; cursor:pointer;">
                    <span><i class="fab fa-facebook" style="color:#1877f2;"></i> Follow</span> <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <!-- Ads Section -->
            <div class="glass-card">
                <h3 style="font-family:'Orbitron'; margin-top:0;"><i class="fas fa-satellite-dish"></i> AD UNITS</h3>
                <p style="font-size:12px; color:#aaa;">Status: Active | Limit: 20/Day</p>

                <!-- Direct Link Banner -->
                <div class="ad-banner" onclick="watchAd('direct')">
                    <div class="ad-badge">HOT</div>
                    <div style="text-align:center; z-index:2;">
                        <h2 style="margin:0; text-shadow:0 0 10px #000;">SUPER BOOST</h2>
                        <small style="color:#fff;">Click to Earn</small>
                    </div>
                </div>

                <!-- Random Ad Button -->
                <button id="tut-ads" class="hyper-btn" onclick="watchAd('random')">
                    <i class="fas fa-play-circle"></i> WATCH RANDOM AD
                </button>
            </div>
        </div>

        <!-- INVITE TAB -->
        <div id="tab-invite" class="tab-section">
            <div class="glass-card" style="text-align: center;">
                <i class="fas fa-users" style="font-size: 50px; color: var(--secondary); margin-bottom: 15px;"></i>
                <h2 data-key="invite">INVITE FRIENDS</h2>
                <p style="font-size: 13px; color: #ccc; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px;">
                    <b>Rule:</b> You get <span style="color:var(--primary);">$0.03</span> (15k Coins) ONLY after your friend earns <span style="color:var(--danger);">$0.50</span> (250k Coins).
                </p>
                <input type="text" id="ref-link" class="sky-input" readonly>
                <button class="hyper-btn" style="background:var(--secondary);" onclick="copyRef()">COPY LINK</button>
            </div>

            <div class="glass-card">
                <div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid rgba(255,255,255,0.1);">
                    <span>Total Friends</span> <b id="ref-total">0</b>
                </div>
                <div style="display:flex; justify-content:space-between; padding:10px;">
                    <span>Qualified ($0.50+)</span> <b id="ref-qualified" style="color:var(--primary);">0</b>
                </div>
            </div>
        </div>

        <!-- WALLET TAB -->
        <div id="tab-wallet" class="tab-section">
            <div class="glass-card">
                <h3 style="font-family:'Orbitron';">WITHDRAW</h3>
                
                <label style="font-size:12px; color:#aaa;">Amount (Coins)</label>
                <input type="number" id="w-amount" class="sky-input" placeholder="Min: 100,000 ($0.20)">

                <label style="font-size:12px; color:#aaa;">USDT TRC20 Address</label>
                <input type="text" id="w-addr" class="sky-input" placeholder="T......................">

                <button class="hyper-btn" style="background:#00f2ff; color:#000;" onclick="withdraw()">
                    <i class="fas fa-paper-plane"></i> SUBMIT REQUEST
                </button>
            </div>

            <!-- Legal & Contact -->
            <div class="glass-card">
                <h4><i class="fas fa-info-circle"></i> INFO CENTER</h4>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div onclick="openLink('contact')" style="padding:10px; background:rgba(255,255,255,0.05); text-align:center; border-radius:8px; cursor:pointer; font-size:12px;">Contact</div>
                    <div onclick="openLink('privacy')" style="padding:10px; background:rgba(255,255,255,0.05); text-align:center; border-radius:8px; cursor:pointer; font-size:12px;">Privacy</div>
                    <div onclick="openLink('terms')" style="padding:10px; background:rgba(255,255,255,0.05); text-align:center; border-radius:8px; cursor:pointer; font-size:12px;">Terms</div>
                    <div onclick="openLink('about')" style="padding:10px; background:rgba(255,255,255,0.05); text-align:center; border-radius:8px; cursor:pointer; font-size:12px;">About</div>
                </div>
            </div>
        </div>

    </div>

    <!-- NAVIGATION -->
    <nav class="nav-bar" id="tut-nav">
        <div class="nav-link active" onclick="switchTab('home', this)">
            <i class="fas fa-home"></i> <span>HOME</span>
        </div>
        <div class="nav-link" onclick="switchTab('invite', this)">
            <i class="fas fa-user-plus"></i> <span>INVITE</span>
        </div>
        <div class="nav-link" onclick="switchTab('wallet', this)">
            <i class="fas fa-wallet"></i> <span>WALLET</span>
        </div>
    </nav>

    <script>
        // --- CONFIGURATION ---
        const DIRECT_LINK = "https://otieu.com/4/10025037"; // Direct Link Provided
        const BOT_USER = "SkyTaskBot"; // Sunan Bot
        const ADMIN_MSG_ID = "v6_update_001"; // Change ID to show new message

        // Economy
        const COINS_PER_USD = 500000; // 10k = $0.02 -> 500k = $1.00
        const USD_RATE = 0.02; // Value of 10k coins
        const REF_THRESHOLD = 250000; // Referee must earn 250k
        const REF_REWARD = 15000; // Referrer gets 15k

        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyCQkS_O4H_PLAX_OPler4oOJdto40kgAdQ",
            authDomain: "topskytask-52db7.firebaseapp.com",
            projectId: "topskytask-52db7",
            storageBucket: "topskytask-52db7.firebasestorage.app",
            messagingSenderId: "310202865241",
            appId: "1:310202865241:web:0b5110369b8344800dc348"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.setHeaderColor('#050b14');

        // State
        let userId = "guest_v6";
        let balance = 0;
        let totalEarned = 0;
        let adCount = 0;
        let lastAdTime = 0;
        let lang = "en";

        // --- INITIALIZATION ---
        window.onload = function() {
            if (tg.initDataUnsafe?.user) {
                const u = tg.initDataUnsafe.user;
                userId = u.id.toString();
                document.getElementById('user-name').innerText = u.first_name.toUpperCase();
                if(u.photo_url) document.getElementById('user-pic').src = u.photo_url;
                
                // Referral Check
                const ref = tg.initDataUnsafe.start_param;
                if(ref && ref !== userId) handleReferral(ref);
            }

            document.getElementById('ref-link').value = `https://t.me/${BOT_USER}?start=${userId}`;
            initDB();
            
            // Check Admin Msg
            if(localStorage.getItem('msg_id') !== ADMIN_MSG_ID || (Date.now() - localStorage.getItem('msg_time') > 86400000)) {
                document.getElementById('admin-modal').style.display = 'flex';
            }
        };

        function setLang(l) {
            lang = l;
            document.getElementById('lang-modal').style.display = 'none';
            // Here you would implement full text replacement based on 'l'
            // For brevity, using English default but structure is ready.
            
            // Start Tutorial if first time
            if(!localStorage.getItem('tut_done')) startTutorial();
        }

        function initDB() {
            db.ref('users/' + userId).on('value', snap => {
                const data = snap.val();
                if (data) {
                    balance = data.balance || 0;
                    totalEarned = data.totalEarned || 0;
                    
                    // Daily Limit Reset
                    const today = new Date().toDateString();
                    if(data.lastAdDate !== today) {
                        adCount = 0;
                        db.ref('users/'+userId).update({lastAdDate: today, adCount: 0});
                    } else {
                        adCount = data.adCount || 0;
                    }

                    // Hide Bonus if done
                    if(data.bonusDone) document.getElementById('bonus-card').style.display = 'none';

                    updateUI();
                    checkReferralQualification(data.referredBy, data.referralPaid);
                } else {
                    db.ref('users/' + userId).set({
                        balance: 0, totalEarned: 0, joined: Date.now()
                    });
                }
            });
        }

        function updateUI() {
            document.getElementById('bal-disp').innerText = balance.toLocaleString();
            document.getElementById('usd-disp').innerText = ((balance / 10000) * 0.02).toFixed(4);
        }

        // --- AD LOGIC (4 UNITS + RANDOM + LIMIT) ---
        function watchAd(type) {
            // 1. Security Checks
            if(adCount >= 20) return Swal.fire({icon:'error', title:'Daily Limit', text:'Come back tomorrow!', background:'#000', color:'#fff'});
            
            const now = Date.now();
            if(now - lastAdTime < 20000) return Swal.fire({icon:'warning', title:'Cooldown', text:'Wait 20 seconds...', timer:2000, showConfirmButton:false, background:'#000', color:'#fff'});

            lastAdTime = now;

            // 2. Random Selection (Direct vs SDK)
            // Units: 0=Direct, 1=Interstitial, 2=Vignette, 3=Reward
            let unit = Math.floor(Math.random() * 4); 
            if(type === 'direct') unit = 0; // Force direct if clicked banner

            if (unit === 0) {
                // Direct Link
                tg.openLink(DIRECT_LINK);
                simulateReward();
            } else if (typeof show_10544727 === 'function') {
                // Monetag SDK
                show_10544727().then(() => {
                    giveReward(100);
                }).catch(e => {
                    // Fallback to Direct if SDK fails
                    tg.openLink(DIRECT_LINK);
                    simulateReward();
                });
            } else {
                // Fallback Simulation (Browser)
                simulateReward();
            }
        }

        function simulateReward() {
            Swal.fire({
                title: 'Verifying...',
                html: 'Watching Ad content...',
                timer: 10000, // 10 seconds wait
                timerProgressBar: true,
                didOpen: () => Swal.showLoading(),
                background: '#050b14', color: '#fff'
            }).then(() => {
                giveReward(100);
            });
        }

        function giveReward(amt) {
            db.ref('users/' + userId).transaction(u => {
                if(u) {
                    u.balance = (u.balance || 0) + amt;
                    u.totalEarned = (u.totalEarned || 0) + amt;
                    u.adCount = (u.adCount || 0) + 1;
                }
                return u;
            });
            Swal.fire({icon:'success', title:`+${amt} Coins`, toast:true, position:'top', background:'rgba(0,242,255,0.2)', color:'#fff', showConfirmButton:false, timer:2000});
        }

        // --- REFERRAL SYSTEM ---
        function handleReferral(refId) {
            db.ref('users/'+userId+'/referredBy').once('value', s => {
                if(!s.exists()) db.ref('users/'+userId+'/referredBy').set(refId);
            });
        }

        function checkReferralQualification(referrer, isPaid) {
            // Rule: Total Earned >= 250,000
            if(totalEarned >= REF_THRESHOLD && referrer && !isPaid) {
                // Pay Referrer
                db.ref('users/'+referrer+'/balance').transaction(b => (b||0) + REF_REWARD);
                db.ref('users/'+userId+'/referralPaid').set(true);
            }
        }

        // --- BONUS TASKS ---
        let bonusProgress = 0;
        function doBonus(platform, el) {
            let url = platform === 'tg' ? 'https://t.me/test' : (platform === 'yt' ? 'https://youtube.com' : 'https://facebook.com');
            tg.openLink(url);
            el.style.opacity = "0.5";
            el.onclick = null;
            bonusProgress++;
            if(bonusProgress >= 3) {
                giveReward(1000); // 1000 coins bonus
                db.ref('users/'+userId+'/bonusDone').set(true);
            }
        }

        // --- WITHDRAW ---
        function withdraw() {
            const amt = parseInt(document.getElementById('w-amount').value);
            const addr = document.getElementById('w-addr').value;
            
            if(!amt || amt < 100000) return Swal.fire({icon:'error', title:'Min: 100,000 Coins', background:'#000', color:'#fff'});
            if(amt > balance) return Swal.fire({icon:'error', title:'Insufficient Funds', background:'#000', color:'#fff'});
            if(addr.length < 10) return Swal.fire({icon:'error', title:'Invalid Address', background:'#000', color:'#fff'});

            db.ref('users/'+userId+'/balance').transaction(b => b - amt, (err, committed) => {
                if(committed) {
                    db.ref('withdrawals/'+userId).push({amount: amt, address: addr, date: Date.now(), status: 'pending'});
                    Swal.fire({icon:'success', title:'Request Sent', text:'Processing in 24h', background:'#000', color:'#fff'});
                }
            });
        }

        // --- UI HELPERS ---
        function switchTab(t, el) {
            document.querySelectorAll('.tab-section').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(d => d.classList.remove('active'));
            document.getElementById('tab-'+t).classList.add('active');
            el.classList.add('active');
        }

        function closeAdmin() {
            document.getElementById('admin-modal').style.display = 'none';
            localStorage.setItem('msg_id', ADMIN_MSG_ID);
            localStorage.setItem('msg_time', Date.now());
        }

        function copyRef() {
            const l = document.getElementById('ref-link');
            l.select(); document.execCommand('copy');
            Swal.fire({icon:'success', title:'Copied', toast:true, position:'bottom', background:'#000', color:'#fff', showConfirmButton:false, timer:1500});
        }

        function openLink(t) { tg.openLink('https://example.com/'+t); }

        // --- TUTORIAL ---
        function startTutorial() {
            const mask = document.getElementById('tutorial-overlay');
            const box = document.getElementById('tut-box');
            const txt = document.getElementById('tut-text');
            mask.style.display = 'block';

            function hl(elId, msg) {
                const rect = document.getElementById(elId).getBoundingClientRect();
                box.style.top = rect.top + 'px'; box.style.left = rect.left + 'px';
                box.style.width = rect.width + 'px'; box.style.height = rect.height + 'px';
                txt.innerText = msg; txt.style.top = (rect.top - 60) + 'px'; txt.style.left = (rect.left) + 'px';
            }

            hl('tut-balance', 'Here is your Wallet Balance.');
            setTimeout(() => hl('tut-ads', 'Click here to Watch Ads & Earn!'), 3000);
            setTimeout(() => hl('tut-nav', 'Use Menu to Navigate.'), 6000);
            setTimeout(() => {
                mask.style.display = 'none';
                localStorage.setItem('tut_done', 'true');
            }, 9000);
        }

    </script>
</body>
</html>